SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";
CREATE DATABASE quanliquannet;

CREATE TABLE `customers` (
  `id_nguoi` int(8) NOT NULL,
  `taikhoan` varchar(20) NOT NULL,
  `matkhau` varchar(32) NOT NULL,
  `SoDu` int(10) NOT NULL,
  `SoMay` int(2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `donhang` (
  `id_don` int(8) NOT NULL,
  `id_sp` int(8) NOT NULL,
  `id_nguoi` int(8) NOT NULL,
  `tg_dat` datetime NOT NULL,
  `ten_sp` varchar(1000) NOT NULL,
  `gia` int(7) NOT NULL,
  `SoMay` int(2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `fooddrink` (
  `id_sp` int(8) NOT NULL,
  `ten_sp` varchar(1000) NOT NULL,
  `gia` int(7) NOT NULL,
  `hinhanh` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `game` (
  `id_game` int(8) NOT NULL,
  `ten_game` varchar(1000) NOT NULL,
  `thongtin_game` varchar(10000) NOT NULL,
  `image_game` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `gameaccount` (
  `id_nguoi` int(8) NOT NULL,
  `taikhoan` varchar(20) NOT NULL,
  `matkhau` varchar(32) NOT NULL,
  `avatar` varchar(255) DEFAULT NULL,
  `gia` int(7) NOT NULL,
  `id_game` int(8) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

ALTER TABLE `customers`
  ADD PRIMARY KEY (`id_nguoi`),
  ADD KEY `taikhoan` (`taikhoan`),
  ADD KEY `SoMay` (`SoMay`),
  ADD KEY `matkhau` (`matkhau`);
  
ALTER TABLE `donhang`
  ADD PRIMARY KEY (`id_don`),
  ADD KEY `id_sp` (`id_sp`),
  ADD KEY `SoMay` (`SoMay`);
  
ALTER TABLE `fooddrink`
  ADD PRIMARY KEY (`id_sp`);
  
ALTER TABLE `game`
  ADD PRIMARY KEY (`id_game`);
  
ALTER TABLE `gameaccount`
  ADD PRIMARY KEY (`id_nguoi`),
  ADD KEY `taikhoan` (`taikhoan`),
  ADD KEY `matkhau` (`matkhau`),
  ADD KEY `id_game` (`id_game`);
  
ALTER TABLE `customers`
  ADD CONSTRAINT `customers_ibfk_1` FOREIGN KEY (`taikhoan`) REFERENCES `gameaccount` (`taikhoan`) ON UPDATE CASCADE,
  ADD CONSTRAINT `customers_ibfk_2` FOREIGN KEY (`SoMay`) REFERENCES `donhang` (`SoMay`) ON UPDATE CASCADE;

ALTER TABLE `donhang`
  ADD CONSTRAINT `donhang_ibfk_1` FOREIGN KEY (`id_sp`) REFERENCES `fooddrink` (`id_sp`) ON UPDATE CASCADE;

ALTER TABLE `gameaccount`
  ADD CONSTRAINT `gameaccount_ibfk_1` FOREIGN KEY (`matkhau`) REFERENCES `customers` (`matkhau`) ON UPDATE CASCADE,
  ADD CONSTRAINT `gameaccount_ibfk_2` FOREIGN KEY (`id_game`) REFERENCES `game` (`id_game`) ON UPDATE CASCADE;
COMMIT;
